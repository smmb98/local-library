<%- include('./includes/layout.ejs') %>
</head>

<body>
	<%- include('./includes/sidebar.ejs') %>

	<h1><%= title %></h1>

	<form action="" method="post">
		<div class="form-group">
			<label for="title">Title: </label>
			<input type="text" id="title" class="form-control" placeholder="Name of book" name="title" value="<% typeof book === 'undefined' ? '' : book.name %>" required='true'>
		</div>

		<div class="form-group">
			<label for="author">Author: </label>
			<select type="text" id="author" class="form-control" placeholder="Select author" name="author" required='true'>
                <option value="" disabled selected hidden>Select author</option>
				<% authors.sort(function(a, b) {
                    let textA = a.family_name.toUpperCase();
                    let textB = b.family_name.toUpperCase();
                    return (textA < textB) ? -1 : (textA > textB) ? 1 : 0;}); 
                %>
				<% for (let author of authors) { %>
				<% if (typeof book !== 'undefined') { %>
                    
				<option value="<%= author._id %>" selected="<% author._id.toString() === book.author._id.toString() ? 'selected' : false %>"><%= author.name %></option>

				<% } else { %>
				<option value="<%= author._id %>"><%= author.name %></option>
				<% } %>
				<% } %>
            </select>
		</div>
		<div class="form-group">
			<label for="summary">Summary: </label>
			<textarea name="summary" id="summary" class="form-control" required='true', placeholder='Summary'><%= "undefined" === typeof book ? '' : book.summary %></textarea>
		</div>
			
		<div class="form-group">
			<label for="isbn">ISBN: </label>
			<input type="text" name="isbn" id="isbn" class="form-control" placeholder='ISBN13' value="<%= "undefined" === typeof book ? '' : book.isbn %>" required='true'>
		</div>

		<div class="form-group">
			<label>Genre: </label>
			<div>
				<% genres.forEach(genre => { %>
				<div style='display: inline; padding-right:10px;'>
					<input type="checkbox" name="genre" id="genre._id" class="checkbox-input" value="<%=  genre._id %>" checked="genre.checked">
					<label for="genre._id"><%= genre.name %></label>
				</div>
				<% }) %>
			</div>

		</div>

		<button class="btn btn-primary" type="submit">Submit</button>
	</form>

	<% if (typeof errors !== 'undefined') { %>
	<ul>
		<% errors.forEach(error => { %>
		<li><%= error.msg %></li>
		<% }) %>
	</ul>
	<% } %>

	</div>
	<!--From sidebar.ejs, class="col-sm-10"  -->
	</div>
	<!--From sidebar.ejs, class="row"  -->
	</div>
	<!--From sidebar.ejs, class="container-fluid"  -->
</body>

</html>

